/* =================================================================
   Sanavera MP3 - v2.1 Hoja de Estilos (FIX COMPLETO)
   Descripción: Estilos corregidos con layout de reproductor funcional,
   animación de scroll y estilos para modales de playlists.
   ================================================================= */

:root {
  --bg: #0e0f13; --elev-1: #161821; --elev-2: #1b1e27; --elev-3: #222634;
  --text: #f6f7fb; --text-muted: #aab0c0; --brand: #5ee192; --brand-hover: #37c977;
  --line: #2a2f3e; --danger: #ff4757;
  --nav-height: 70px; --safe-area: env(safe-area-inset-bottom);
  --content-padding: 16px; --radius-md: 12px;
  --shadow-md: 0 4px 16px rgba(0,0,0,.25); --shadow-lg: 0 8px 32px rgba(0,0,0,.35);
  --transition: 200ms cubic-bezier(.4,0,.2,1);
}

*, *::before, *::after { box-sizing: border-box; -webkit-tap-highlight-color: transparent; }
html { color-scheme: dark; }
body {
  margin: 0; background-color: var(--bg); color: var(--text);
  font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Inter, system-ui, sans-serif;
  overflow: hidden; height: 100vh; width: 100vw;
}
button { font-family: inherit; }

#app-container { height: 100%; width: 100%; overflow: hidden; display: flex; flex-direction: column; }

/* ======================= VISTAS ======================= */
.view {
  flex: 1; overflow: hidden; display: none; flex-direction: column; background-color: var(--bg);
  padding-bottom: calc(var(--nav-height) + var(--safe-area));
}
.view.active { display: flex; }
.view-content { flex: 1; overflow-y: auto; -webkit-overflow-scrolling: touch; }
.view-header { padding: 24px var(--content-padding) 16px; background: var(--elev-1); border-bottom: 1px solid var(--line); }
.view-header h1 { margin: 0; font-size: 24px; }

/* ======================= NAVEGACIÓN INFERIOR ======================= */
#bottom-nav {
  position: fixed; bottom: 0; left: 0; right: 0; z-index: 1000;
  height: calc(var(--nav-height) + var(--safe-area));
  background: rgba(22, 24, 33, 0.85); backdrop-filter: blur(20px);
  border-top: 1px solid var(--line); display: flex; justify-content: space-around;
  padding: 10px 0 var(--safe-area); box-shadow: 0 -4px 20px rgba(0,0,0,0.3);
}
.nav-link {
  background: none; border: none; color: var(--text-muted); cursor: pointer;
  display: flex; flex-direction: column; align-items: center; gap: 4px;
  font-size: 10px; padding: 4px 12px; transition: color var(--transition);
}
.nav-link i { font-size: 22px; }
.nav-link:hover { color: var(--text); }
.nav-link.active { color: var(--brand); }

/* ======================= BÚSQUEDA ======================= */
.search-header { padding: 24px var(--content-padding) 16px; background: linear-gradient(to bottom, var(--elev-1) 80%, transparent); }
.search-row { display: flex; gap: 12px; }
#search-input {
  flex: 1; background: var(--elev-2); color: var(--text); border: 1px solid var(--line);
  border-radius: var(--radius-md); padding: 12px 16px; font-size: 16px; outline: none;
  transition: all var(--transition);
}
#search-input:focus { border-color: var(--brand); background: var(--bg); box-shadow: 0 0 0 3px rgba(94, 225, 146, .2); }
#search-button {
  width: 48px; height: 48px; min-width: 48px; padding: 0; border: none; border-radius: 50%;
  background: var(--elev-2); color: var(--brand); font-size: 18px; cursor: pointer;
  display: flex; align-items: center; justify-content: center; transition: all var(--transition);
}
#search-button:hover { background: var(--elev-3); transform: scale(1.05); }
#album-list { display: grid; grid-template-columns: repeat(auto-fill, minmax(150px, 1fr)); gap: 18px; padding: 0 var(--content-padding) 32px; }
.album-item { cursor: pointer; transition: transform var(--transition); }
.album-item:hover { transform: translateY(-4px); }
.album-item img { width: 100%; aspect-ratio: 1 / 1; object-fit: cover; border-radius: var(--radius-md); background: var(--elev-2); box-shadow: var(--shadow-md); }
.album-item-info { padding: 10px 4px 0; }
.album-item-info h3 { margin: 0; font-size: 14px; line-height: 1.3; font-weight: 600; display: -webkit-box; -webkit-line-clamp: 2; -webkit-box-orient: vertical; overflow: hidden; }
.album-item-info p { margin: 4px 0 0; font-size: 12px; color: var(--text-muted); white-space: nowrap; overflow: hidden; text-overflow: ellipsis; }

/* ======================= REPRODUCTOR ======================= */
#player-view { padding-bottom: 0; /* Layout especial */ }
.player-layout { display: flex; flex-direction: column; height: 100%; }
.player-hero {
  width: 100%; aspect-ratio: 1 / 1; max-height: 45vh;
  background-color: var(--elev-1); background-size: cover; background-position: center;
  background-image: var(--cover-url); display: flex; flex-direction: column; justify-content: flex-end;
  padding: 24px var(--content-padding); text-shadow: 0 2px 8px rgba(0,0,0,.6);
  transform-origin: bottom center; transition: transform 150ms linear, opacity 150ms linear;
}
.player-hero::before { content: ''; position: absolute; inset: 0; background: linear-gradient(to top, rgba(14,15,19,1) 0%, rgba(14,15,19,0.8) 25%, transparent 60%); }
.hero-text { position: relative; text-align: center; }
.hero-text h2 { margin: 0 0 6px; font-size: clamp(22px, 5.5vw, 28px); font-weight: 700; }
.hero-text p { margin: 0; font-size: clamp(14px, 3.8vw, 16px); color: var(--text-muted); }

#player-tracklist-wrapper { flex: 1; overflow-y: auto; }

.player-controls-wrapper {
  background: var(--elev-1);
  padding: 12px var(--content-padding) calc(12px + var(--nav-height) + var(--safe-area));
  box-shadow: 0 -4px 20px rgba(0,0,0,0.3); border-top: 1px solid var(--line);
}
.controls-section { display: flex; flex-direction: column; gap: 12px; }
#seek-bar { width: 100%; }
.controls { display: flex; justify-content: space-between; align-items: center; }
.btn { background: none; border: none; color: var(--text); width: 44px; height: 44px; border-radius: 50%; display: flex; align-items: center; justify-content: center; font-size: 18px; cursor: pointer; }
.btn-play { width: 60px; height: 60px; font-size: 24px; background: var(--brand); color: var(--bg); }
.btn-play .fa-pause { display: none; }
.btn-play.playing .fa-play { display: none; } .btn-play.playing .fa-pause { display: inline-block; }
.btn.active { color: var(--brand); }
.time-info { display: flex; justify-content: space-between; font-size: 12px; color: var(--text-muted); padding-top: 6px; }

/* ======================= LISTAS DE CANCIONES (Genérico) ======================= */
.playlist { padding: 12px var(--content-padding); display: flex; flex-direction: column; gap: 6px; }
.playlist-item { display: flex; align-items: center; gap: 12px; padding: 8px; border-radius: 8px; transition: background-color var(--transition); cursor: pointer; }
.playlist-item:hover { background-color: var(--elev-1); }
.playlist-item.active { background-color: var(--elev-2); }
.playlist-item.active h3 { color: var(--brand); }
.playlist-item img { width: 48px; height: 48px; border-radius: 6px; object-fit: cover; flex-shrink: 0; background-color: var(--elev-2); }
.playlist-item-info { min-width: 0; flex: 1; }
.playlist-item-info h3 { margin: 0; font-size: 15px; font-weight: 600; white-space: nowrap; overflow: hidden; text-overflow: ellipsis; display: flex; align-items: center; gap: 10px; }
.playlist-item-info p { margin: 2px 0 0; font-size: 13px; color: var(--text-muted); white-space: nowrap; overflow: hidden; text-overflow: ellipsis; }
.playlist-item-actions { margin-left: auto; display: flex; }
.btn-icon { background: none; border: none; color: var(--text-muted); font-size: 18px; padding: 10px; border-radius: 50%; cursor: pointer; transition: all var(--transition); }
.btn-icon:hover { color: var(--text); background: var(--elev-3); }
.btn-favorite.active { color: var(--danger); }

/* ======================= MODALES ======================= */
.modal {
    position: fixed; inset: 0; z-index: 2000; background: rgba(0,0,0,0.5);
    display: flex; justify-content: center; align-items: center;
    opacity: 0; visibility: hidden; transition: all var(--transition);
}
.modal.active { opacity: 1; visibility: visible; }
.modal-content {
    background: var(--elev-1); border-radius: var(--radius-md);
    padding: 24px; width: 90%; max-width: 400px;
    box-shadow: var(--shadow-lg); transform: scale(0.95);
    transition: transform var(--transition);
}
.modal.active .modal-content { transform: scale(1); }
.modal-header { display: flex; justify-content: space-between; align-items: center; margin-bottom: 16px; }
.modal-header h2 { margin: 0; font-size: 18px; }
.modal-close { background: none; border: none; color: var(--text-muted); font-size: 20px; cursor: pointer; }
.modal-body form { display: flex; flex-direction: column; gap: 16px; }
.form-group input { width: 100%; background: var(--elev-2); border: 1px solid var(--line); border-radius: 8px; padding: 12px; font-size: 16px; color: var(--text); }
.form-actions { display: flex; justify-content: flex-end; gap: 12px; margin-top: 8px; }
.btn-primary { background-color: var(--brand); color: var(--bg); border: none; padding: 10px 20px; border-radius: 8px; font-weight: 600; cursor: pointer; }
#add-to-playlist-options { display: flex; flex-direction: column; gap: 8px; max-height: 50vh; overflow-y: auto; }

/* ======================= ESTADOS Y UTILIDADES ======================= */
.empty-state, .loading-state, #loading-indicator { text-align: center; padding: 48px var(--content-padding); color: var(--text-muted); font-weight: 500; }
#loading-indicator { display: none; }
.icon { font-size: 24px; color: var(--text-muted); width: 48px; text-align: center; }
.new-playlist-btn { background: none; border: 1px dashed var(--line); color: var(--text-muted); width: 100%; justify-content: center; }
